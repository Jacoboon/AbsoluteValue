<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Absolute Value — Parallel Reader</title>
    <meta name="description" content="Proof-of-concept parallel scripture reader with source templates" />
    <link rel="stylesheet" href="./styles.css?v=20251004a" />
  </head>
  <body>
    <div id="app">
      <aside id="sidebar" class="expanded">
        <div class="sidebar-header">
          <button id="toggle-sidebar" title="Toggle navigation">☰</button>
          <h1>Library</h1>
        </div>
        <nav id="nav-tree" aria-label="Book Navigation"></nav>
      </aside>

      <main id="main">
        <header id="topbar">
          <div class="bar-left">
            <label for="book-select" class="sr-only">Book</label>
            <select id="book-select" title="Select Book"></select>

            <button id="prev-chapter" class="nav-btn" title="Previous chapter">◀ Prev</button>
            <span id="chapter-label" aria-live="polite"></span>
            <button id="next-chapter" class="nav-btn" title="Next chapter">Next ▶</button>
          </div>
          <div class="bar-right">
            <span class="versions-label">Versions:</span>
            <div id="template-versions" class="chips" aria-live="polite"></div>
            <label for="add-version" class="sr-only">Add Version</label>
            <select id="add-version" title="Add a version">
              <option value="">+ Add version…</option>
            </select>
            <button id="share-link" class="icon-btn" title="Copy shareable link">Share</button>
            <button id="reset-state" class="icon-btn" title="Reset to defaults">Reset</button>
          </div>
        </header>

        <section id="chapter-content" aria-live="polite"></section>

        <div id="error-banner" style="display:none; color:#ffb4b4; padding:8px 14px; border-top:1px solid var(--border); background: #2a1a1a;">
          <strong>Error:</strong> <span id="error-text"></span>
        </div>

        <footer id="bottombar">
          <button id="prev-chapter-bottom" class="nav-btn">◀ Prev</button>
          <button id="next-chapter-bottom" class="nav-btn">Next ▶</button>
        </footer>
      </main>
    </div>

    <script>
      // Minimal global error trap to surface issues in Pages
      window.addEventListener('error', function(ev) {
        var b = document.getElementById('error-banner');
        var t = document.getElementById('error-text');
        if (b && t) {
          b.style.display = 'block';
          t.textContent = (ev && ev.message) ? ev.message : 'Unknown error';
        }
      });
      window.addEventListener('unhandledrejection', function(ev){
        var b = document.getElementById('error-banner');
        var t = document.getElementById('error-text');
        if (b && t) {
          b.style.display = 'block';
          t.textContent = (ev && ev.reason && (ev.reason.message || ev.reason)) || 'Unhandled promise rejection';
        }
      });
    </script>
    <script type="module" src="./app.js?v=20251004a"></script>
  </body>
  </html>
